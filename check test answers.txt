Q10. check test answers: 
Create a SQL query to evaluate test answers stored in a table named playground.answers with columns id (unique question ID), correct_answer (string), and given_answer (which can be NULL). Return a table with columns id and checks, where checks is "no answer" if given_answer is NULL, "correct" if given_answer matches correct_answer, and "incorrect" otherwise. Order the results by id.

SELECT id,
  CASE
  When given_answer IS NULL Then 'no answer'
  WHEN given_answer = correct_answer Then 'correct'
  ELSE 'incorrect'
  END as checks
  FROM playground.answers

Q12.Top Reviewed Customers per Product: Using the table playground.product_reviews, write a SQL query to identify, for each product, the customer who provided the highest review score. If there are ties in review score, the customer with the most helpful votes should be considered top. The output should include columns for product_id, customer_id, review_score, and helpful_votes, capturing the details of the top review for each product ordered in ascending order of product_id
 

SELECT product_id, 
  customer_id, 
  max(review_score) as review_score,
  max(helpful_votes) as helpful_votes
  FROM playground.product_reviews 
  GROUP BY product_id, customer_id
  ORDER BY product_id asc

Q13. Find US Customers Who Rented and Streamed Videos in Early February: 
Write a SQL query to return the US customers who rented a video on February 1st, 2023, and then streamed the same video between February 2nd and February 8th, 2023. Use the tables playground.rental for rental data and playground.streams for streaming data. The output should include unique user IDs of these customers ordered in ascending order.

SELECT u.user_id
  FROM playground.rental u
  JOIN playground.streams s 
  ON u.user_id = s.user_id
  WHERE u.rental_date = Cast('2023-02-01' as date)
  AND s.stream_date between Cast('2023-02-02' as date)
  and Cast('2023-02-08' as date)
  AND u.country = 'US'

Q14. Analyze Yearly Profit Performance:
 Write a SQL query to analyze the profit performance of the company throughout the years using the playground.superstore table. Ensure to convert profit from varchar to a suitable numeric type for aggregation. The output should include the year extracted from the order_date (order_year), the total annual profit (total_profit) rounded to two decimal places, and should be ordered by year in descending order.

SELECT year((order_date)) as order_year,
  round(sum(profit), 2) as total_profit
  FROM playground.superstore 
  GROUP By year((order_date))
  Order by order_year desc
